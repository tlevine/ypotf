ypotf
=========
Mailing list software that runs as an IMAP and SMTP client.

The person managing the mailing list provides ypotf with an ordinary
email account, and people interact with the mailing list by sending and
receiving emails to and from this account.

Running a mailing list
----------------------
Install from PyPI. ::

    pip install ypotf

Make an email account, and run ypotf with the appropriate credentials.
The first time you run it, it's a good idea to run a test to make sure
that the credentials are set up properly. ::

    ypotf --username=ypotf@thomaslevine.com --password=acbeusar \
      --imap-host=mail.messagingengine.com:992 \
      --smtp-host=mail.messagingengine.com:465 \
      --test

Then run it without the test option. ::

    ypotf --username=ypotf@thomaslevine.com --password=acbeusar \
      --imap-host=mail.messagingengine.com:992 \
      --smtp-host=mail.messagingengine.com:465

ypotf processes any new emails that have been sent to the email address
(These are documented in the next section.) and then exits.
If you run ypotf this way, you have to run it periodically in order to
process any new commands; if you want it to run at 30-second intervals,
for example, you can run this.

    ypotf --username=ypotf@thomaslevine.com --password=acbeusar \
      --imap-host=mail.messagingengine.com:992 \
      --smtp-host=mail.messagingengine.com:465 \
      --watch=30s

Interacting with a mailing list
-------------------------------
People can send the following sorts of emails to the email account.

* Subscription requests
* Unsubscription requests
* Responses to confirmation emails
* Requests for documentation on using the mailing list
* Messages to the list's members

The type of email is specified in the subject line of the email;
here are the subject line formats associated with each sort of email.

.. csv-table ::
  
    Type of email,Subject line
    Subscription request,"subscribe" (case-insensitive)
    Unsubscription request,"unsubscribe" (case-insensitive)
    Response to confirmation email,"confirm"\, followed by a message-id
    Request for documentation,"help" (case-insensitive)
    Messages to the list members,Anything else

Some of these make sense only if you have a certain status; for example,
subscription requests make sense only if you are subscribed. If you try
to send something that doesn't make sense, it is mostly treated as a
documentation request.

Now let's discuss what each of these sorts of emails do.

Subscription requests
^^^^^^^^^^^^^^^^^^^^^
A subscription request is a request for one email address to receive
messages that are sent to list members. In response to such a request,
ypotf sends a confirmation message


Message type flow
^^^^^^^^^^^^^^^^^

(Make a graphviz thing.)
